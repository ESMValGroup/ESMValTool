# ESMValTool
# 
---
documentation:
  title: Performance metrics plots.
  description: >
    Compare performance of model simulations to a reference dataset.
  authors:
    - ruhe_lukas
    # - cammarano_diego
  references:
    - eyring21ipcc


preprocessors:
  default:
    custom_order: true
    extract_time:
      start_year: 1990
      start_month: 1
      start_day: 1
      end_year: 1992
      end_month: 12
      end_day: 31
    regrid:
      target_grid: 3x3
      # scheme: nearest
      scheme:
        reference: esmf_regrid.schemes:ESMFAreaWeighted
    regrid_time:
      calendar: standard
      frequency: mon
    distance_metric:
      metric: pearsonr
      # coords: null


cmip6_default: &cmip6
  grid: gn
  ensemble: r1i1p1f1
  project: CMIP6
  timerange: '1990/1992'

datasets:
  # ICON
  # - {project: ICON,
  #    timerange: '1991/1992', 
  #    dataset: ICON-Seamless,
  #    exp: hist001,
  #    horizontal_grid: /work/pd1295/ICON/grids/public/edzw/icon_grid_0030_R02B05_G.nc,
  #    supplementary_variables: [
  #     {short_name: areacella, skip: true},
  #     {short_name: areacello, skip: true},
  #     {short_name: sftlf, skip: true},
  #     {short_name: sftof, skip: true},
  #    ],
  #    ugrid: false,
  #   }
  # - {project: ICON,
  #     timerange: '1991/1992',
  #    dataset: ICON-Seamless,
  #    exp: hist002,
  #    horizontal_grid: /work/pd1295/ICON/grids/public/edzw/icon_grid_0030_R02B05_G.nc,
  #    supplementary_variables: [
  #     {short_name: areacella, skip: true},
  #     {short_name: areacello, skip: true},
  #     {short_name: sftlf, skip: true},
  #     {short_name: sftof, skip: true},
  #    ],
  #    ugrid: false,
  #   }
  # CMIP6
  # - {<<: *cmip6, dataset: ACCESS-CM2, reference_for_metric: true}
  - {<<: *cmip6, dataset: AWI-CM-1-1-MR}
  - {<<: *cmip6, dataset: AWI-ESM-1-1-LR}

  - {<<: *cmip6, dataset: CESM2-FV2, institute: NCAR}
  - {<<: *cmip6, dataset: CESM2-WACCM, institute: NCAR}
  - {<<: *cmip6, dataset: CESM2-WACCM-FV2, institute: NCAR}
  - {<<: *cmip6, dataset: CIESM, grid: gr}
  - {<<: *cmip6, dataset: CMCC-CM2-HR4}
  # # - {<<: *cmip6, dataset: CMCC-CM2-SR5}
  # - {<<: *cmip6, dataset: CNRM-CM6-1, ensemble: r1i1p1f2, grid: gr}
  # # - {<<: *cmip6, dataset: CNRM-CM6-1-HR, ensemble: r1i1p1f2, grid: gr}
  # # - {<<: *cmip6, dataset: CNRM-ESM2-1, ensemble: r1i1p1f2, grid: gr}
  # # - {<<: *cmip6, dataset: EC-Earth3-Veg-LR, grid: gr}
  # - {<<: *cmip6, dataset: FGOALS-f3-L, grid: gr}
  # - {<<: *cmip6, dataset: FGOALS-g3}
  # - {<<: *cmip6, dataset: GFDL-CM4, grid: gr1}
  # - {<<: *cmip6, dataset: GISS-E2-1-G}
  # - {<<: *cmip6, dataset: GISS-E2-1-H}
  # - {<<: *cmip6, dataset: HadGEM3-GC31-LL, ensemble: r1i1p1f3}
  # - {<<: *cmip6, dataset: HadGEM3-GC31-MM, ensemble: r1i1p1f3}


  # - {<<: *cmip6, dataset: IITM-ESM}
  # - {<<: *cmip6, dataset: INM-CM4-8, grid: gr1}
  # - {<<: *cmip6, dataset: INM-CM5-0, grid: gr1}
  # - {<<: *cmip6, dataset: IPSL-CM6A-LR, grid: gr}
  # - {<<: *cmip6, dataset: MIROC6, reference_for_metric: true}
  # - {<<: *cmip6, dataset: MIROC-ES2L, ensemble: r1i1p1f2}
  # - {<<: *cmip6, dataset: MPI-ESM-1-2-HAM}
  # - {<<: *cmip6, dataset: MPI-ESM1-2-LR}
  # - {<<: *cmip6, dataset: MPI-ESM1-2-HR}
  # - {<<: *cmip6, dataset: MRI-ESM2-0}
  # - {<<: *cmip6, dataset: NESM3}
  # - {<<: *cmip6, dataset: NorCPM1, institute: NCC, ensemble: r10i1p1f1}
  # - {<<: *cmip6, dataset: NorESM2-LM, institute: NCC}
  # - {<<: *cmip6, dataset: NorESM2-MM, institute: NCC}
  # - {<<: *cmip6, dataset: SAM0-UNICON}
  # - {<<: *cmip6, dataset: TaiESM1}
  # - {<<: *cmip6, dataset: UKESM1-0-LL, ensemble: r1i1p1f2}


diagnostics:
  perfmetric:
    description: perfmetric in python
    variables:
      pr: &var_default
        preprocessor: default
        mip: Amon
        exp: historical
        ref: ref1
        # ensemble: r1i1p1
        # alternative_dataset: GHCN
        additional_datasets: &ref1
          - {<<: *cmip6, dataset: BCC-ESM1, reference_for_metric: true}
          - {project: ICON, dataset: ICON, exp: icon-2.6.1_atm_amip_R2B4_r1v1i1p1l1f1}
          # - {project: ICON, dataset: ICON, exp: ag_atm_amip_r2b4_cfm, supplementary_variables: [{short_name: areacella, skip: true}]} 

          # - {
          #     project: ICON,
          #     timerange: '1990/1991', 
          #     dataset: ICON-Seamless,
          #     exp: hist001,
          #     horizontal_grid: /work/pd1295/ICON/grids/public/edzw/icon_grid_0030_R02B05_G.nc,
          #     supplementary_variables: [
          #       {short_name: areacella, skip: true},
          #       {short_name: areacello, skip: true},
          #       {short_name: sftlf, skip: true},
          #       {short_name: sftof, skip: true},
          #     ],
          #     ugrid: false,
          #   }
      pr_ref2: &var_default_ref2
        <<: *var_default
        short_name: pr
        ref: ref2
        additional_datasets: &ref2
          - {<<: *cmip6, dataset: ACCESS-ESM1-5, institute: CSIRO, reference_for_metric: true}
      tas:
        ref: ref1
        <<: *var_default

      tas_ref2:
        short_name: tas
        <<: *var_default_ref2
      # rlut: 
      #   <<: *var_default
      ps:
        ref: ref1
        <<: *var_default
      # sfcWind:
      #   <<: *var_default
      clt:
        ref: ref1
        <<: *var_default
      # rlut:
      #   <<: *var_default
      # psl:
      #   ref: ref1
      #   <<: *var_default


    # additional_datasets:
      # - {dataset: ERA5, project: native6, type: reanaly, 
      #   version: v1, tier: 3, reference_for_metric: true}

    #   - {<<: *cmip6, dataset: MPI-ESM-MR, type: exp, project: CMIP5, exp: historical,
    #  ensemble: r1i1p1}
    #   - {<<: *cmip6, dataset: CMCC-ESM2}
    #   - {<<: *cmip6, dataset: E3SM-1-1, institute: E3SM-Project, grid: gr}
    #   - {<<: *cmip6, dataset: E3SM-1-0, grid: gr}
    #   - {<<: *cmip6, dataset: E3SM-1-1-ECA, institute: E3SM-Project, grid: gr}
    #   - {<<: *cmip6, dataset: GFDL-ESM4, grid: gr1}
      
    #   # grid wrong? missing data
    #   # - {<<: *cmip6, dataset: MCM-UA-1-0}
    #   # - {<<: *cmip6, dataset: GISS-E2-1-G-CC}
    #   # - {<<: *cmip6, dataset: IPSL-CM5A2-INCA, grid: gr}
    #   # - {<<: *cmip6, dataset: KACE-1-0-G, grid: gr}

    #   - {<<: *cmip6, dataset: KIOST-ESM, grid: gr1}
    #   - {<<: *cmip6, dataset: EC-Earth3, grid: gr}
    #   - {<<: *cmip6, dataset: EC-Earth3-AerChem, grid: gr}
    #   - {<<: *cmip6, dataset: EC-Earth3-CC, grid: gr}
    #   - {<<: *cmip6, dataset: EC-Earth3-Veg, grid: gr}

    scripts:
      python:
        script: perfmetrics/main.py
        group_by: project

  # tas: &pcmip6, dataset: MCM-UA-1-0}
  #     - {dataset: ERA5, project: native6, type: reanaly, version: v1, tier: 3}
  #     - {dataset: NCEP-NCAR-R1, project: OBS6, type: reanaly, version: 1, tier: 2}

  # clt:
  #   <<:torical
  #   additional_datasets:
  #     - {<<: *cmip6, dataset: BCC-ESM1}
  #     - {dataset: ESACCI-CLOUD, project: OBS, type: sat,
  #        version: AVHRR-fv3.0, tier: 2, timerange: '1982/1999'}
  #     - {dataset: PATMOS-x, project: OBS, type: sat, version: NOAA, tier: 2,
  #        timerange: '1982/1999'}

  # pr:
  #     - {dataset: GPCP-SG, project: obs4MIPs, level: L3, version: v2.3, tier: 1}
  #     - {dataset: GHCN, project: OBS, type: ground, version: 1, tier: 2}

  # psl:
  #   <<: aset: MCM-UA-1-0}
  #     - {dataset: JRA-55, project: ana4mips, type: reanalysis, tier: 1}
  #     - {dataset: ERA5, project: native6, type: reanaly, version: v1, tier: 3}


  # rlut:
  #   6, dataset: MCM-UA-1-0}
  #     - {dataset: CERES-EBAF, project: obs4MIPs, level: L3B, version: Ed2-8,
  #        tier: 1, start_year: 2001, end_year: 2015}

  # rsut:
  #   <<: *perfp6, dataset: KIOST-ESM, grid: gr1}
  #     - {dataset: CERES-EBAF, project: obs4MIPs, level: L3B, version: Ed2-8,
  #        tier: 1, start_year: 2001, end_year: 2015}

