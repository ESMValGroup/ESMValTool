# ESMValTool
# recipe_forster23.yml
---
documentation:
  title:
    Using similar attrib as Gillett et al. (2023) but for Canada
  description: |
    Produces estimates of attributable warming for Canada.

  authors:
    - kirchmeier-young_megan
    - cowtan_kevin
    - gillett_nathan
    - malinina_elizaveta

  references:
    - gillett20ncc


preprocessors:

  regrid_5_5:
    custom_order: true
    annual_statistics:
      operator: max
    regrid:
      target_grid: 5x5
      scheme: linear
    extract_shape:
      shapefile: canada.shp
      method: contains
      crop: True
    anomalies:
      period: full
      reference:
        start_year: 1961
        start_month: 1
        start_day: 1
        end_year: 1990
        end_month: 12
        end_day: 31

datasets_models: &datasets_models
  - {dataset: CanESM5, ensemble: "r(1:25)i1p1f1", grid: gn}
  - {dataset: CanESM5, ensemble: "r(1:25)i1p2f1", grid: gn}
  - {dataset: CanESM5, ensemble: "r(1:10)i1p1f1", grid: gn, exp: [hist-nat,ssp245-nat]}
  - {dataset: CanESM5, ensemble: "r(1:10)i1p1f1", grid: gn, exp: [hist-GHG,ssp245-GHG]}
  - {dataset: CanESM5, ensemble: "r(1:10)i1p1f1", grid: gn, exp: [hist-aer,ssp245-aer]}
  - {dataset: CanESM5, ensemble: "r(1:10)i1p1f1", grid: gn, exp: [hist-stratO3,ssp245-stratO3]}
  # - {dataset: IPSL-CM6A-LR, ensemble: "r(1:6)i1p1f1"}
  # - {dataset: IPSL-CM6A-LR, ensemble: "r10i1p1f1"}
  # - {dataset: IPSL-CM6A-LR, ensemble: "r11i1p1f1"}
  # - {dataset: IPSL-CM6A-LR, ensemble: "r14i1p1f1"}
  # - {dataset: IPSL-CM6A-LR, ensemble: "r22i1p1f1"}
  # - {dataset: IPSL-CM6A-LR, ensemble: "r25i1p1f1"}
  # - {dataset: IPSL-CM6A-LR, ensemble: "r4i1p1f1", exp: [hist-nat,ssp245-nat]}
  # - {dataset: IPSL-CM6A-LR, ensemble: "r(3:4)i1p1f1", exp: [hist-GHG,ssp245-GHG]}
  # - {dataset: IPSL-CM6A-LR, ensemble: "r(8:10)i1p1f1", exp: [hist-GHG,ssp245-GHG]}
  - {dataset: MIROC6, ensemble: "r(1:3)i1p1f1", grid: gn} 
  - {dataset: MIROC6, ensemble: "r(21:29)i1p1f1", grid: gn}
  - {dataset: MIROC6, ensemble: "r(31:34)i1p1f1", grid: gn}
  - {dataset: MIROC6, ensemble: "r(36:37)i1p1f1", grid: gn}
  - {dataset: MIROC6, ensemble: "r(39:40)i1p1f1", grid: gn}
  - {dataset: MIROC6, ensemble: "r(42:47)i1p1f1", grid: gn}
  - {dataset: MIROC6, ensemble: "r(49:50)i1p1f1", grid: gn}
  - {dataset: MIROC6, ensemble: "r(1:50)i1p1f1", grid: gn, exp: [hist-nat,ssp245-nat]}
  - {dataset: MIROC6, ensemble: "r(1:50)i1p1f1", grid: gn, exp: [hist-GHG,ssp245-GHG]}
  - {dataset: MIROC6, ensemble: "r(1:10)i1p1f1", grid: gn, exp: [hist-aer,ssp245-aer]}
  # - {dataset: NorESM2-LM, ensemble: "r(2:3)i1p1f1", grid: gn} #1 didn't work.
  # - {dataset: NorESM2-LM, ensemble: "r1i1p1f1", grid: gn, exp: [hist-nat,ssp245-nat]}
  # - {dataset: NorESM2-LM, ensemble: "r1i1p1f1", grid: gn, exp: [hist-GHG,ssp245-GHG]}
  # - {dataset: NorESM2-LM, ensemble: "r1i1p1f1", grid: gn, exp: [hist-aer,ssp245-aer]}

diagnostics:


  # **********************************************************************
  # Preprocess tas, tos, siconc data by regridding to HadCRUT4 grid.
  # **********************************************************************

  gillett20_figs:
    description: Preprocess data needed for Gillett et al. (2021) update for Forster et al. (2023).
    variables:
      models:
        short_name: tasmax
        preprocessor: regrid_5_5   
        mip: day
        project: CMIP6
        exp: [historical,ssp245]
        grid: gr
        start_year: 1944
        end_year: 2023
        additional_datasets: *datasets_models


    scripts:
      fig1: 
        script: attribute/damip_timeseries_txx.py
        year_block: 1 
        warming_base: [1949, 1978]
        warming_years: [2014, 2023]

      fig2_14-23: 
        script: attribute/attrib_blended_txx.py
        year_block: 5 
        warming_base: [1949, 1978]
        exp_flag: GHG
        rcplot: true
        simple_uncert: false
        warming_years: [2014, 2023]