# recipe_deangelis15nat_f3.yml
---
documentation:
  title: Water vapor trend histogram (IPCC AR6).
  description: |
    Recipe for reproducing the plots from B. D. Santer

  authors:
    - weigel_katja

  references:
    - santer20jclim

  projects:
    - eval4cmip
    - 4c

preprocessors:
  tropical_ocean:
    mask_landsea:
      mask_out: sea
    regrid:
      target_grid: reference_dataset
      scheme: linear # area_weighted #
    extract_region:
      start_latitude: -50
      end_latitude: 50
      start_longitude: 0
      end_longitude: 360
    # area_statistics:
    #   operator: mean

diagnostics:
   wvtrend:
    description: Plot figure from B. D. Santer with observations
    variables:
      prw:
        preprocessor: tropical_ocean
        reference_dataset: ERA5
        # project: CMIP5
        # ensemble: r1i1p1
        mip: Amon
        field: T2Ms
        start_year: 2003 # 1988 # #1988 # 
        end_year: 2017 #  2019 # 2019 # 2017 #  
        derive: false
          # - {dataset: SSMI,  project: obs4mips,  type: satellite, level: L3,  version: RSSv07r00,  start_year: 1988,  end_year: 2015,  tier: 1}
    additional_datasets:
      # - {dataset: RSS,  project: OBS,  type: reanaly_1,  version: v07r01,  tier: 2}
      - {dataset: ERA5, project: native6, type: reanaly, version: '1', tier: 3}
      - {dataset: ESACCI-WATERVAPOUR, project: OBS, type: sat,
         version: CDR2-L3S-05deg_fv3.1, tier: 3}
      - {dataset: ESACCI-WATERVAPOUR, project: OBS, type: sat, version: CDR1-L3C-05deg_fv3.2, alias: ESACCI-WATERVAPOUR_CDR1,
         tier: 3, tag: 'OBS'}
      # - {dataset: ESACCI-TCWV-CDR1, project: OBS, type: sat,
      #    version: L3-05deg_fv3.1, start_year: 2003, end_year: 2014, tier: 3}
      # - {dataset: ACCESS-CM2, institute: CSIRO-ARCCSS, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:3)i1p1f1, grid: gn}
      # - {dataset: ACCESS-ESM1-5, institute: CSIRO, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:3)i1p1f1, grid: gn}
      # - {dataset: ACCESS-ESM1-5, institute: CSIRO, project: CMIP6, exp: [historical, ssp585], ensemble: r2i1p1f1, grid: gn}
      # - {dataset: ACCESS-ESM1-5, institute: CSIRO, project: CMIP6, exp: [historical, ssp585], ensemble: r3i1p1f1, grid: gn}
      - {dataset: CanESM5, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:25)i1p1f1, grid: gn}
      - {dataset: CanESM5, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:10)i1p2f1, grid: gn}
      - {dataset: CanESM5, project: CMIP6, exp: [historical, ssp585], ensemble: r12i1p2f1, grid: gn}
      - {dataset: CESM2-WACCM, institute: NCAR, project: CMIP6, exp: [historical, ssp585], ensemble: r1i1p1f1, grid: gn}
      # r1i1p1f1 and r2i1p1f1 for ssp585 retracted
      # - {dataset: CESM2, institute: NCAR, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:2)i1p1f1, grid: gn}
      - {dataset: CESM2, institute: NCAR, project: CMIP6, exp: [historical, ssp585], ensemble: r(10:11)i1p1f1, grid: gn}
      - {dataset: CESM2, institute: NCAR, project: CMIP6, exp: [historical, ssp585], ensemble: r4i1p1f1, grid: gn}
      # ESGF file for ssp585 corrupted/retracted
      # - {dataset: CIESM, institute: THU, project: CMIP6, exp: [historical, ssp585], ensemble: r1i1p1f1, grid: gr}
      - {dataset: CNRM-CM6-1, institute: CNRM-CERFACS, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:6)i1p1f2, grid: gr}
        # Some years are missing, maybe retreated?   
      - {dataset: EC-Earth3, institute: EC-Earth-Consortium,project: CMIP6, exp: [historical, ssp585], ensemble: r1i1p1f1,grid: gr}
      # - {dataset: EC-Earth3, institute: EC-Earth-Consortium,project: CMIP6, exp: [historical, ssp585], ensemble: r4i1p1f1,grid: gr}
      - {dataset: EC-Earth3, institute: EC-Earth-Consortium,project: CMIP6, exp: [historical, ssp585], ensemble: r6i1p1f1,grid: gr}
      - {dataset: EC-Earth3, institute: EC-Earth-Consortium,project: CMIP6, exp: [historical, ssp585], ensemble: r11i1p1f1,grid: gr}
      - {dataset: EC-Earth3, institute: EC-Earth-Consortium,project: CMIP6, exp: [historical, ssp585], ensemble: r13i1p1f1,grid: gr}
      # - {dataset: EC-Earth3, institute: EC-Earth-Consortium,project: CMIP6, exp: [historical, ssp585], ensemble: r15i1p1f1,grid: gr}
      # Error (fix needed?)
      # - {dataset: EC-Earth3-Veg, institute: EC-Earth-Consortium, project: CMIP6, exp: [historical, ssp585], ensemble: r1i1p1f1, grid: gr}
      - {dataset: EC-Earth3-Veg, institute: EC-Earth-Consortium, project: CMIP6, exp: [historical, ssp585], ensemble: r(2:3)i1p1f1, grid: gr}
      - {dataset: EC-Earth3-Veg, institute: EC-Earth-Consortium, project: CMIP6, exp: [historical, ssp585], ensemble: r4i1p1f1, grid: gr}
      - {dataset: EC-Earth3-Veg, institute: EC-Earth-Consortium, project: CMIP6, exp: [historical, ssp585], ensemble: r6i1p1f1, grid: gr}
      - {dataset: GFDL-ESM4, institute: NOAA-GFDL, project: CMIP6, exp: [historical, ssp585], ensemble: r1i1p1f1, grid: gr1}
      # ssp585 missing
      # - {dataset: GFDL-CM4, institute: NOAA-GFDL, project: CMIP6, exp: [historical, ssp585], ensemble: r1i1p1f1, grid: gr1}
      - {dataset: HadGEM3-GC31-LL, institute: MOHC, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:3)i1p1f3, grid: gn}
      - {dataset: HadGEM3-GC31-MM, institute: MOHC, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:3)i1p1f3, grid: gn}
      # - {dataset: HadGEM3-GC31-LL, institute: MOHC, project: CMIP6, exp: [historical, ssp585], ensemble: r2i1p1f3, grid: gn}
      # - {dataset: HadGEM3-GC31-LL, institute: MOHC, project: CMIP6, exp: [historical, ssp585], ensemble: r3i1p1f3, grid: gn}
      - {dataset: IPSL-CM6A-LR, institute: IPSL, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:4)i1p1f1, grid: gr}
      # - {dataset: IPSL-CM6A-LR, institute: IPSL, project: CMIP6, exp: [historical, ssp585], ensemble: r2i1p1f1, grid: gr}
      # - {dataset: IPSL-CM6A-LR, institute: IPSL, project: CMIP6, exp: [historical, ssp585], ensemble: r3i1p1f1, grid: gr}
      # - {dataset: IPSL-CM6A-LR, institute: IPSL, project: CMIP6, exp: [historical, ssp585], ensemble: r4i1p1f1, grid: gr}
      - {dataset: IPSL-CM6A-LR, institute: IPSL, project: CMIP6, exp: [historical, ssp585], ensemble: r6i1p1f1, grid: gr}
      - {dataset: IPSL-CM6A-LR, institute: IPSL, project: CMIP6, exp: [historical, ssp585], ensemble: r14i1p1f1, grid: gr}
      - {dataset: MIROC6, institute: MIROC, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:50)i1p1f1, grid: gn}
      # - {dataset: MIROC6, institute: MIROC, project: CMIP6, exp: [historical, ssp585], ensemble: r2i1p1f1, grid: gn}
      # - {dataset: MIROC6, institute: MIROC, project: CMIP6, exp: [historical, ssp585], ensemble: r3i1p1f1, grid: gn}
      - {dataset: MIROC-ES2L, institute: MIROC, project: CMIP6, exp: [historical, ssp585], ensemble: r1i1p1f2, grid: gn}
      # Missing
      # - {dataset: MPI-ESM1-2-HR, institute: MPI-M, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:2)i1p1f1, grid: gn}
      - {dataset: MPI-ESM1-2-LR, institute: MPI-M, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:10)i1p1f1, grid: gn}
      # - {dataset: MPI-ESM1-2-LR, institute: MPI-M, project: CMIP6, exp: [historical, ssp585], ensemble: r8i1p1f1, grid: gn}
      # - {dataset: MPI-ESM1-2-LR, institute: MPI-M, project: CMIP6, exp: [historical, ssp585], ensemble: r9i1p1f1, grid: gn}
      # - {dataset: MPI-ESM1-2-LR, institute: MPI-M, project: CMIP6, exp: [historical, ssp585], ensemble: r10i1p1f1, grid: gn}
      - {dataset: MRI-ESM2-0, institute: MRI, project: CMIP6, exp: [historical, ssp585], ensemble: r1i1p1f1, grid: gn}
      - {dataset: NESM3, institute: NUIST, project: CMIP6, exp: [historical, ssp585], ensemble: r1i1p1f1, grid: gn}
      - {dataset: NESM3, institute: NUIST, project: CMIP6, exp: [historical, ssp585], ensemble: r2i1p1f1, grid: gn}
      - {dataset: NorESM2-MM, institute: NCC, project: CMIP6, exp: [historical, ssp585], ensemble: r1i1p1f1, grid: gn}
      - {dataset: UKESM1-0-LL, institute: MOHC, project: CMIP6, exp: [historical, ssp585], ensemble: r(1:4)i1p1f2, grid: gn}
      # - {dataset: UKESM1-0-LL, institute: MOHC, project: CMIP6, exp: [historical, ssp585], ensemble: r2i1p1f2, grid: gn}
      # - {dataset: UKESM1-0-LL, institute: MOHC, project: CMIP6, exp: [historical, ssp585], ensemble: r3i1p1f2, grid: gn}
      - {dataset: UKESM1-0-LL, institute: MOHC, project: CMIP6, exp: [historical, ssp585], ensemble: r8i1p1f2, grid: gn}
      
      - {dataset: ACCESS1-0, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: ACCESS1-3, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: bcc-csm1-1, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: bcc-csm1-1-m, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      # - {dataset: CanESM2, project: CMIP5, exp: [historical, rcp85], ensemble: r(1:10)i1p1}
      - {dataset: CanESM2, project: CMIP5, exp: [historical-r1], ensemble: r(1:10)i1p1}
      - {dataset: CanESM2, project: CMIP5, exp: [historical-r2], ensemble: r(1:10)i1p1}
      - {dataset: CanESM2, project: CMIP5, exp: [historical-r3], ensemble: r(1:10)i1p1}
      - {dataset: CanESM2, project: CMIP5, exp: [historical-r4], ensemble: r(1:10)i1p1}
      - {dataset: CanESM2, project: CMIP5, exp: [historical-r5], ensemble: r(1:10)i1p1}
      # - {dataset: CanESM2, project: CMIP5, exp: [historical, rcp85], ensemble: r2i1p1}
      # - {dataset: CanESM2, project: CMIP5, exp: [historical, rcp85], ensemble: r3i1p1}
      # - {dataset: CanESM2, project: CMIP5, exp: [historical, rcp85], ensemble: r4i1p1}
      # - {dataset: CanESM2, project: CMIP5, exp: [historical, rcp85], ensemble: r5i1p1}
      - {dataset: CCSM4, project: CMIP5, exp: [historical, rcp85], ensemble: r(1:3)i1p1}
      # - {dataset: CCSM4, project: CMIP5, exp: [historical, rcp85], ensemble: r2i1p1}
      # - {dataset: CCSM4, project: CMIP5, exp: [historical, rcp85], ensemble: r3i1p1}
      
      - {dataset: CESM1-CAM5, project: CMIP5, exp: [historical, rcp85], ensemble: r(1:3)i1p1}
      # data missing
      # - {dataset: CESM1-CAM5, project: CMIP5, exp: [historical, rcp85], ensemble: r(4:40)i1p1}
      - {dataset: CESM1-BGC, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: CSIRO-Mk3-6-0, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      # data missing (prw rcp85)
      # - {dataset: EC-EARTH, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      
      - {dataset: GFDL-CM3, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: GFDL-ESM2G, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: GFDL-ESM2M, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: GISS-E2-H, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      #- {dataset: GISS-E2-H, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p2}
      - {dataset: GISS-E2-H, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p3}
      - {dataset: GISS-E2-R, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: GISS-E2-R, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p2}
      - {dataset: GISS-E2-R, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p3}
      - {dataset: HadGEM2-CC, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: HadGEM2-CC, project: CMIP5, exp: [historical, rcp85], ensemble: r2i1p1}
      - {dataset: HadGEM2-CC, project: CMIP5, exp: [historical, rcp85], ensemble: r3i1p1}
      - {dataset: HadGEM2-ES, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: HadGEM2-ES, project: CMIP5, exp: [historical, rcp85], ensemble: r2i1p1}
      - {dataset: MIROC-ESM, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: MIROC-ESM-CHEM, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      # cannot concatenate cubes
      # - {dataset: MIROC5, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: MPI-ESM-MR, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: MPI-ESM-LR, project: CMIP5, exp: [historical, rcp85], ensemble: r(1:3)i1p1}
      # - {dataset: MPI-ESM-LR, project: CMIP5, exp: [historical, rcp85], ensemble: r2i1p1}
      # - {dataset: MPI-ESM-LR, project: CMIP5, exp: [historical, rcp85], ensemble: r3i1p1}
      # - {dataset: MRI-CGCM3, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: MRI-CGCM3, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: NorESM1-M, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      - {dataset: NorESM1-ME, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      
      # - {dataset: CNRM-CM5, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      # - {dataset: BNU-ESM, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      # - {dataset: IPSL-CM5A-LR, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      # - {dataset: IPSL-CM5A-MR, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}
      # - {dataset: IPSL-CM5B-LR, project: CMIP5, exp: [historical, rcp85], ensemble: r1i1p1}


    scripts:
      santer20jclim:
        script: santer20jclim/santer20jclimfig.py
        # If the keyword filter is not given the recipe runs withoout filtering
        # sample_obs: 'OBS_RSSANOM_filter_anom_v07r01_Amon_prw_198801-201912.nc'
        # Add model names for additional figure with pdf of ensemble members
        add_model_dist: ['CNRM-CM6-1', 'CanESM2', 'CanESM5', 'MIROC6', 'MPI-ESM1-2-LR']






