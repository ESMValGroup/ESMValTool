# Recipe to call ESA CCI LST V3 testing diagnostic.
---
documentation:
  title: ESA CCI LST diagnostic
  description: |
    Please add description here
  authors:
    - king_robert

  maintainer:
    - king_robert

  references:
    - esacci_lst

  projects:
    - cmug

preprocessors:

  obs_preprocessor:
    extract_region:
      start_longitude: 1
      end_longitude: 1.5
      start_latitude: 45
      end_latitude: 45.5

  cmip_preprocessor:
    regrid:
      target_grid: UKESM1-0-LL
      scheme: linear

    extract_region:
      start_longitude: 1
      end_longitude: 1.5
      start_latitude: 45
      end_latitude: 45.5

    mask_landsea:
      mask_out: sea

    area_statistics:
      operator: mean

    # ensemble_statistics:
    #   span: overlap
    #   statistics: [mean, std_dev]
    #   exclude: [ESACCI-LST]


diagnostics:

  timeseries:
    description: ESACCI LST difference to model historical ensemble average
    themes:
      - phys
    realms:
      - land
    variables:
      #ts:
      #  mip: Amon
      #  preprocessor: cmip_preprocessor
      #  additional_datasets:
      #   - {dataset: UKESM1-0-LL, project: CMIP6, exp: historical, ensemble: r1i1p1f2, start_year: 2003, end_year: 2004, grid: gn}

      tsDay:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}


      tsNight:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}
 
      tsLocalSfcErrDay:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}
 
      tsLocalSfcErrNight:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}

      tsLocalAtmErrDay:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}
 
      tsLocalAtmErrNight:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}
 
      tsLSSysErrDay:
        mip: Amon
        # preprocessor: obs_preprocessor # Single value in files, no area cut out needed
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}
 
      tsLSSysErrNight:
        mip: Amon
        # preprocessor: obs_preprocessor # Single value in files, no area cut out needed
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}
 
      tsUnCorErrDay:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}
 
      tsUnCorErrNight:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}

      tsTotalDay:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}

      tsTotalNight:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}

      tsVarDay:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}

      tsVarNight:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}

      tsLCDay:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}

      tsLCNight:
        mip: Amon
        preprocessor: obs_preprocessor
        additional_datasets:
          - {dataset: ESACCI-LST, project: OBS, type: sat, tier: 2, start_year: 2003, end_year: 2004, version: '3.00'}


    scripts:
      script1:
        script: lst/lst_uncert_prop.py