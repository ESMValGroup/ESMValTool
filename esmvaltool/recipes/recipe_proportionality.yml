# ESMValTool
# recipe_proportionality.yml
---
documentation:
  title: Comparison of ocean heat and carbon uptake
  
  description: |
    Recipe to produce figures comparing ocean heat and carbon uptake in 4xCO2.

  authors:
    - gillett_nathan

preprocessors:

 
  global_land:
    weighting_landsea_fraction:
      area_type: land
    area_statistics:
      operator: sum
    annual_statistics:
      operator: mean


  global_ocean:
    weighting_landsea_fraction:
      area_type: sea
    area_statistics:
      operator: sum
      fx_variables:
        areacello:
    annual_statistics:
      operator: mean

  global_mean:
    area_statistics:
      operator: mean
      fx_variables:
        areacella:
    annual_statistics:
      operator: mean



diagnostics:
  diag_prop_figs:
    variables:
      tas: &var_tas
        preprocessor: global_mean
        project: CMIP6
        mip: Amon
        grid: gn
        additional_datasets:  &datasets
          - {dataset: CanESM5, institute: CCCma, exp: abrupt-4xCO2, ensemble: r1i1p2f1, start_year: 1850, end_year: 1999}
          - {dataset: CanESM5, institute: CCCma, exp: piControl, ensemble: r1i1p2f1, start_year: 5550, end_year: 5699}
#          - {dataset: CMCC-ESM2, institute: CMCC, exp: abrupt-4xCO2, ensemble: r1i1p1f1, start_year: 1850, end_year: 1999} #sftof missing.
#          - {dataset: CMCC-ESM2, institute: CMCC, exp: piControl, ensemble: r1i1p1f1, start_year: 1850, end_year: 1999}
          - {dataset: ACCESS-ESM1-5, institute: CSIRO, exp: abrupt-4xCO2, ensemble: r2i1p1f1, start_year: 101, end_year: 250} #missing data.
          - {dataset: ACCESS-ESM1-5, institute: CSIRO, exp: piControl, ensemble: r1i1p1f1, start_year: 601, end_year: 750}
#          - {dataset: IPSL-CM6A-LR, institute: IPSL, exp: abrupt-4xCO2, ensemble: r1i1p1f1, start_year: 101, end_year: 150}
#          - {dataset: IPSL-CM6A-LR, institute: IPSL, exp: piControl, ensemble: r1i1p1f1, start_year: 101, end_year: 150} #gr
#          - {dataset: MPI-ESM1-2-HR, institute: MPI-M, exp: abrupt-4xCO2, ensemble: r1i1p1f1, start_year: 1850, end_year: 1999} #No nbp
#          - {dataset: MPI-ESM1-2-HR, institute: MPI-M, exp: piControl, ensemble: r1i1p1f1, start_year: 1850, end_year: 1999}
          - {dataset: MPI-ESM1-2-LR, institute: MPI-M, exp: abrupt-4xCO2, ensemble: r1i1p1f1, start_year: 1850, end_year: 1999}
          - {dataset: MPI-ESM1-2-LR, institute: MPI-M, exp: piControl, ensemble: r1i1p1f1, start_year: 1850, end_year: 1999}
#          - {dataset: MRI-ESM2-0, institute: MRI, exp: abrupt-4xCO2, ensemble: r1i2p1f1, start_year: 1850, end_year: 1999} #No nbp
#          - {dataset: MRI-ESM2-0, institute: MRI, exp: piControl, ensemble: r1i1p1f1, start_year: 1850, end_year: 1999}
          - {dataset: CESM2, institute: NCAR, exp: abrupt-4xCO2, ensemble: r1i1p1f1, start_year: 1, end_year: 150} 
          - {dataset: CESM2, institute: NCAR, exp: piControl, ensemble: r1i1p1f1, start_year: 502, end_year: 651}
#          - {dataset: CESM2-FV2, institute: NCAR, exp: abrupt-4xCO2, ensemble: r1i1p1f1, start_year: 1, end_year: 150} #cat problem
#          - {dataset: CESM2-FV2, institute: NCAR, exp: piControl, ensemble: r1i1p1f1, start_year: 321, end_year: 470}
#          - {dataset: CESM2-WACCM, institute: NCAR, exp: abrupt-4xCO2, ensemble: r1i1p1f1, start_year: 1, end_year: 150} #too similar to cesm2.
#          - {dataset: CESM2-WACCM, institute: NCAR, exp: piControl, ensemble: r1i1p1f1, start_year: 70, end_year: 219}
#          - {dataset: CESM2-WACCM-FV2, institute: NCAR, exp: abrupt-4xCO2, ensemble: r1i1p1f1, start_year: 1, end_year: 150} #too similar to cesm2.
#          - {dataset: CESM2-WACCM-FV2, institute: NCAR, exp: piControl, ensemble: r1i1p1f1, start_year: 301, end_year: 450}
#          - {dataset: NorESM2-LM, institute: NCC, exp: abrupt-4xCO2, ensemble: r1i1p1f1, start_year: 1, end_year: 150} #Missing years 121-150 nbp.
#          - {dataset: NorESM2-LM, institute: NCC, exp: piControl, ensemble: r1i1p1f1, start_year: 1600, end_year: 1749}
          - {dataset: NorESM2-MM, institute: NCC, exp: abrupt-4xCO2, ensemble: r1i1p1f1, start_year: 1, end_year: 150}
          - {dataset: NorESM2-MM, institute: NCC, exp: piControl, ensemble: r1i1p1f1, start_year: 1201, end_year: 1350}


#      co2:
#        preprocessor: global_mean
#        project: CMIP6
#        mip: Amon
#        grid: gn
#        additional_datasets:  *datasets

      nbp:
        preprocessor: global_land #land_fraction_weighting
        project: CMIP6
        mip: Lmon
        grid: gn
        additional_datasets: *datasets

      fgco2:
        preprocessor: global_ocean
        project: CMIP6
        mip: Omon
        grid: gn
        additional_datasets: *datasets

      hfds:
        preprocessor: global_ocean
        project: CMIP6
        mip: Omon
        grid: gn
        additional_datasets: *datasets


    scripts:
      fig_proportionality:
        script: prop_figs.py
  
 