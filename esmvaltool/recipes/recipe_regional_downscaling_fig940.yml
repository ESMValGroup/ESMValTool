# ESMValTool
# recipe_regionaldownscaling.yml
---
documentation:
  description: |
    Diagnostics for regional downscaling 

  authors:
    - cionni_irene

  maintainer:
    - cionni_irene

  references:
    - flato13ipcc 

  projects:
    - crescendo 


datasets:
#  - {dataset: ERA-40, project: OBS, type: reanaly, version: v1,
#         start_year: 1980, end_year: 1999, tier: 3}
#  - {dataset: ACCESS1-0, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1990, end_year: 1999}
#  - {dataset: ACCESS1-3, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1980, end_year: 1999}
#  - {dataset: bcc-csm1-1, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1980, end_year: 1999}
#  - {dataset: bcc-csm1-1-m, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1980, end_year: 1999}
#  - {dataset: BNU-ESM, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1980, end_year: 1999}
#  - {dataset: CanESM2, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1980, end_year: 1999}
#  - {dataset: CCSM4, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1980, end_year: 1999}
#  - {dataset: CESM1-BGC, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1980, end_year: 1999}
  # - {dataset: CESM1-CAM5-1-FV, project: CMIP5, exp: historical,
  #    ensemble: r1i1p1, start_year: 1980, end_year: 1999}
#  - {dataset: CESM1-CAM5, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1980, end_year: 1999}
#  - {dataset: CESM1-FASTCHEM, project: CMIP5, exp: historical,
#     ensemble: r1i1p1, start_year: 1986, end_year: 1999}
#  - {dataset: CESM1-WACCM, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1980, end_year: 1999}
#  - {dataset: CMCC-CESM, project: CMIP5, exp: historical, ensemble: r1i1p1,
#     start_year: 1980, end_year: 1999}
  # - {dataset: CMCC-CM, project: CMIP5, exp: historical, ensemble: r1i1p1,
  #    start_year: 1980, end_year: 1999}
  # - {dataset: CMCC-CMS, project: CMIP5, exp: historical, ensemble: r1i1p1,
  #    start_year: 1980, end_year: 1999}
  # - {dataset: CNRM-CM5-2, project: CMIP5, exp: historical, ensemble: r1i1p1,
  #    start_year: 1986, end_year: 1999}
  - {dataset: CNRM-CM5, project: CMIP5, exp: historical, ensemble: r1i1p1,
    start_year: 1986, end_year: 2005}
 # - {dataset: CSIRO-Mk3-6-0, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1980, end_year: 1999}
  # - {dataset: FGOALS-g2, project: CMIP5, exp: historical, ensemble: r1i1p1,
  #    start_year: 1980, end_year: 1999}
 # - {dataset: GFDL-CM3, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1980, end_year: 1999}
 # - {dataset: GFDL-ESM2G, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1980, end_year: 1999}
 # - {dataset: GFDL-ESM2M, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1980, end_year: 1999}
 # - {dataset: GISS-E2-H-CC, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1980, end_year: 1999}
  # - {dataset: GISS-E2-H, project: CMIP5, exp: historical, ensemble: r1i1p1,
  #    start_year: 1980, end_year: 1999}
 # - {dataset: GISS-E2-R-CC, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1980, end_year: 1999}
 # - {dataset: GISS-E2-R, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1980, end_year: 1999}
  # - {dataset: HadGEM2-CC, project: CMIP5, exp: historical, ensemble: r1i1p1,
  #    start_year: 1980, end_year: 1999}
  # - {dataset: HadGEM2-ES, project: CMIP5, exp: historical, ensemble: r1i1p1,
  #    start_year: 1980, end_year: 1999}
 # - {dataset: inmcm4, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1980, end_year: 1999}
 # - {dataset: IPSL-CM5A-LR, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}
 # - {dataset: IPSL-CM5A-MR, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}
 # - {dataset: IPSL-CM5B-LR, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}
 # - {dataset: MIROC4h, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}
 # - {dataset: MIROC5, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}
  - {dataset: MIROC-ESM, project: CMIP5, exp: historical, ensemble: r1i1p1,
     start_year: 1986, end_year: 2005}
 # - {dataset: MIROC-ESM-CHEM, project: CMIP5, exp: historical,
 #    ensemble: r1i1p1, start_year: 1980, end_year: 1999}
 # - {dataset: MPI-ESM-LR, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}
 # - {dataset: MPI-ESM-MR, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}
 # - {dataset: MPI-ESM-P, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}
 # - {dataset: MRI-CGCM3, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}
 # - {dataset: NorESM1-M, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}
 # - {dataset: NorESM1-ME, project: CMIP5, exp: historical, ensemble: r1i1p1,
 #    start_year: 1986, end_year: 1999}

preprocessors:
  annual_cycle:
    regrid:
      target_grid: reference_dataset 
      scheme: linear
    climate_statistics:
      operator: mean
      period: month
    #mask_landseaice:
    #  mask_out: ice
    mask_landsea: 
      mask_out: sea
    mask_fillvalues:
      threshold_fraction: 0.95
  clima:
    regrid:
      target_grid: reference_dataset
      scheme: linear
    climate_statistics:
      operator: mean
      period: month
    #mask_landseaice:
    #  mask_out: ice
      mask_out: sea
    mask_fillvalues:
      threshold_fraction: 0.95

  clima_nomask:
    regrid:
      target_grid: reference_dataset
      scheme: linear
    climate_statistics:
      operator: mean
      period: month
    mask_fillvalues:
      threshold_fraction: 0.95

diagnostics:

  # ==========================================================================
  # Chapter 9  - Figure940 
  # ==========================================================================

  regional_downscaling_Fig940:
    description: Creates seasonal or annual bias box plots at selected regions over the selected project&experiemnt&mip.N.B. different regions and mask respect to Figure939
    themes:
      - chem
    realms:
      - atmos
    variables:
      tas:
        preprocessor: clima_nomask 
        reference_dataset: ERA-Interim
        mip: Amon
    additional_datasets:
      - {dataset: ERA-Interim, project: OBS6, type: reanaly, version: 2,
         start_year: 1986, end_year: 2005, tier: 3}
    scripts:
      clim: &clim_settings
        script: regional_downscaling/Figure9.40.ncl
        # projection
        # ----------
        # map projection, e.g., Mollweide, Mercator, CylindricalEquidistant
        projection: CylindricalEquidistant
        # timemean: annualclim  
        # timemean
        # --------
        showdiff: false
        styleset: CMIP5
        fig940_season: ["DJF","JJA","ANN"]
        fig940_region_label: ["Arctic_land","Arctic_sea","Antarctic_land","Antarctic_sea","Caribbean","WesternIndianOcean","NorthernIndianOcean","NorthernTropicalPacific","EquatorialTropicalPacific","SouthernTropicalPacific","World_land","World_sea","World"]
        fig940_project_MMM: ["CMIP5"]
        fig940_experiment_MMM: ["historical"]
        fig940_mip_MMM: ["Amon"]
        fig940_colors_MMM: ["red"]
        fig940_refModel: ERA-Interim 
        fig940_MMM: True
 #      fig940_mode: "cumulative"
#       fig940_vert_line_pos: [6,10,13,17,24,26]
#       fig940_vert_line_label=["North America","South America","Europe","Africa","Asia","Australia"]
#        @legend_position        : legend position in ncd coordinates     
#        @fig940_YMin        : minimum Y Axis
#        @fig940_YMax        : maxiclima#                                                     
#
