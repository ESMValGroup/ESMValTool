# ESMValTool
# recipe_water_vapor_variability.yml
---
documentation:

  title: Analysis of water vapor variability in CMIP6 models.

  description: This is a recipe for analysing water vapor variability in CMIP6 models.

  authors:
    - malinina_elizaveta

preprocessors:
  annual_globe_regrid: &regrid
    regrid:
      target_grid: reference_dataset
      scheme: linear
  winter_globe: &winter
    extract_season:
      season: JFM
  spring_globe: &spring
    extract_season:
      season: AMJ
  summer_globe: &summer
    extract_season:
      season: JAS
  fall_globe: &fall
    extract_season:
      season: OND
  winter_regrid:
    <<: *regrid
    <<: *winter
  spring_regrid:
    <<: *regrid
    <<: *spring
  summer_regrid:
    <<: *regrid
    <<: *summer
  fall_regrid: 
    <<: *regrid
    <<: *fall

datasets_cmip_126: &datasets_cmip_126
  - {dataset: CMCC-CM2-SR5, ensemble: r1i1p1f1, grid: gn, project: CMIP6}
  - {dataset: CMCC-ESM2, ensemble: r1i1p1f1, grid: gn, project: CMIP6}
  - {dataset: CNRM-CM6-1-HR, ensemble: r1i1p1f2, grid: gr, project: CMIP6}
  - {dataset: CNRM-CM6-1, ensemble: r1i1p1f2, grid: gr, project: CMIP6}
  - {dataset: CNRM-ESM2-1, ensemble: r1i1p1f2, grid: gr, project: CMIP6}
  - {dataset: HadGEM3-GC31-LL, ensemble: r1i1p1f3, grid: gn, project: CMIP6}
  - {dataset: HadGEM3-GC31-MM, ensemble: r1i1p1f3, grid: gn, project: CMIP6}
  - {dataset: MIROC6, ensemble: "r(1:3)i1p1f1", grid: gn, project: CMIP6}
  - {dataset: MPI-ESM1-2-LR, ensemble: "r(11:30)i1p1f1", grid: gn, project: CMIP6}
  - {dataset: NorESM2-LM, ensemble: r1i1p1f1, grid: gn, project: CMIP6}
  - {dataset: NorESM2-MM, ensemble: r1i1p1f1, grid: gn, project: CMIP6}
  - {dataset: UKESM1-0-LL, ensemble: "r(1:4)i1p1f2", grid: gn, project: CMIP6}
  - {dataset: UKESM1-0-LL, ensemble: "r(8:12)i1p1f2", grid: gn, project: CMIP6}
  - {dataset: UKESM1-0-LL, ensemble: "r(16:19)i1p1f2", grid: gn, project: CMIP6}
  # - {dataset: CESM2, ensemble: r4i1p1f1, grid: gn} 1 Jan 2015 problem
  # - {dataset: CESM2, ensemble: "r(10:11)i1p1f1", grid: gn}
  # - {dataset: CESM2-WACCM, ensemble: r1i1p1f1, grid: gn}

datasets_cmip_245: &datasets_cmip_245
  - {dataset: GFDL-CM4, institute: NOAA-GFDL, ensemble: r1i1p1f1, grid: gr2, project: CMIP6}
  - {dataset: MIROC6, ensemble: "r(1:3)i1p1f1", grid: gn, project: CMIP6}
  - {dataset: MPI-ESM1-2-LR, ensemble: "r(11:30)i1p1f1", grid: gn, project: CMIP6}
  - {dataset: NorESM2-LM, ensemble: "r(1:3)i1p1f1", grid: gn, project: CMIP6}
  - {dataset: NorESM2-MM, ensemble: "r(1:2)i1p1f1", grid: gn, project: CMIP6}

dataset_era: &dataset_era
  - {dataset: ERA5, project: OBS6, type: reanaly, version: v1, tier: 3}

dataset_obs: &datasets_obs
  - {dataset: ESACCI-WATERVAPOUR, project: OBS6, type: sat,
             version: CDR2-L3S-05deg_fv3.1, tier: 3}

diagnostics:
  prw_now:
    description: Figure for water vapour variability
    variables:
      annual:
        short_name: prw
        preprocessor: annual_globe_regrid
        exp: [historical, ssp126]
        start_year: 1980
        end_year: 2022
        mip: Eday
        reference_dataset: ERA5
        additional_datasets: *dataset_era
    additional_datasets: *datasets_cmip_126
      # winter:
      #   short_name: prw
      #   exp: [historical, ssp126]
      #   start_year: 1980
      #   end_year: 2022
      #   mip: Eday
      #   reference_dataset: ERA5
      #   additional_datasets: *datasets_cmip_126
      #                        *dataset_era
        
    scripts: 
      maps:
        script: water_vapour/distribution_moments_maps.py 
        mpl_style: cccma_wv
      slopes: 
        script: water_vapour/distribution_moments_slopes.py
        mpl_style: cccma_wv