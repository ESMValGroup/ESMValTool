# walrus.yml
---
documentation:
  description:
    The recipe prepares the input data from ERA5 for implementing WALRUS.
    WALRUS needs a dataframe saved as .dat. Data need to be organized as time series.
    The columns are 'date', 'P' (pr in CMIP6 tables), 'ETpot' (evspsblpot in CMIP6 tables) and 'Q'.
    The 'Q' is observation dataset that should be provided if calibration is true (like in the PEQ_Hupsel.dat) or can be filled as NA.
    The WALRUS_snow processor needs two more variables, 'T' (tas in CMIP6 tables) and 'GloRad' (rsds in CMIP6 tables).
    The WALRUS is a lumped model. So, the coordinates of the area can be provided as a shapefile or geojson file.
    All the data should be averaged over the area.
    The output is saved as a .dat file in the working directory.

  authors: ['dros_ni', 'ande_bo']

datasets:
  - {dataset: ERA5, project: OBS6, tier: 3, type: reanaly, version: 1}

diagnostics:
  diagnostic1:
    description: Extracting data for WALRUS.
    variables:
      pr: &var
        mip: E1hr
        start_year: 2011
        end_year: 2012
      evspsblpot: *var
      tas: *var
      rsds: *var
    scripts:
      script1:
        model: WALRUS
        script: hydrology/walrus/walrus.py
        dataname: 'PEQ_Hupsel'
        model_calib: false
        calibdata: 'PEQ_Hupsel.dat'
        geojfile: 'walrus-hupsel.geojson'
        weighting_method: 'mean_inside'
        convert_units: true
        write_dat: true
