# ESMValTool 
# recipe_seaice_extents_sh.yml
---
documentation:
  title: SH sea ice area recipe
  description: |
    Converted a COSIMA cookbook recipe with help 
    from Anton Steketee

  authors:
    - chun_felicity
    - steketee_anton
    
  maintainer:
    - chun_felicity

  realms:
    - seaIce

  projects:
    - access-nri

preprocessors:
  trends_min: &trends
    mask_outside_range:
      minimum: 15
      maximum: 100
    extract_region:
      start_longitude: 0
      end_longitude: 360
      start_latitude: -90
      end_latitude: 0
    area_statistics:
      operator: sum
    annual_statistics:
      operator: min
    convert_units: 
      units: km2

  trends_max:
    <<: *trends
    annual_statistics:
      operator: max
    convert_units: 
      units: km2

  map_extents:
    climate_statistics:
      operator: mean
      period: monthly
    extract_region: 
      start_longitude: 0
      end_longitude: 360
      start_latitude: -90
      end_latitude: -50
    regrid:
      target_grid: 0.5x0.5
      scheme: linear

datasets: 

  - {dataset: ACCESS-ESM1-5, activity: CMIP ,project: CMIP6,  grid: gn,
     exp: historical, ensemble: r1i1p1f1, start_year: 1981, end_year: 2010} 

# the years 306-366 are comparable to 1958 -2018 
# re-adjust years in trends script (+1652)
  - {dataset: ACCESS-OM2, activity: OMIP ,project: CMIP6,  grid: gn,
     exp: omip2, ensemble: r1i1p1f1, start_year: 329, end_year: 358, offset_years: 1652} 

# observations
  - {dataset: NSIDC-G02202-sh, project: OBS6, tier: 3,
     type: reanaly, version: 4, start_year: 1981, end_year: 2010,
     supplementary_variables: [{short_name: areacello, mip: Ofx}]
     } #- 2018


diagnostics:

  sea_ice_extents_sh:
    description: sea ice extents
    variables:
      siconc:
        mip: SImon
        preprocessor: map_extents
    scripts:
      map_extents:
        months: [2,9] # months to map (feb, sep)
        script: seaice_area_extents/seaice_mapextents.py
  
  sea_ice_trends_sh:
    description: sea ice trends
    variables:
      siconc_min:
        short_name: siconc
        mip: SImon
        preprocessor: trends_min
      siconc_max:
        short_name: siconc
        mip: SImon
        preprocessor: trends_max
    scripts: 
      trends:
        script: seaice_area_extents/seaicearea_trends.py