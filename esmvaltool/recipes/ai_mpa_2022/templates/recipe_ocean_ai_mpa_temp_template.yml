# ESMValTool
# recipe_ocean_ai_mpa_template.yml
---
documentation:
  description: |
    Template recipe to produce a generic plot of temperature for the Ascension Islands.

  authors:
    - demora_lee

  maintainer:
    - demora_lee

  references:
    - demora2018gmd

  projects:
    - ukesm


#datasets:
#   - {project: CMIP6, mip: Omon, grid: gn, dataset: UKESM1-0-LL, exp: historical, ensemble: r1i1p1f2, start_year: 1850, end_year: 2014}
#   - {project: CMIP6, mip: Omon, grid: gn, dataset: UKESM1-0-LL, exp: ssp126, ensemble: r1i1p1f2, start_year: 2015, end_year: 2100}
#   - {project: CMIP6, mip: Omon, grid: gn, dataset: UKESM1-0-LL, exp: ssp245, ensemble: r1i1p1f2, start_year: 2015, end_year: 2100}
#   - {project: CMIP6, mip: Omon, grid: gn, dataset: UKESM1-0-LL, exp: ssp370, ensemble: r1i1p1f2, start_year: 2015, end_year: 2100}
#   - {project: CMIP6, mip: Omon, grid: gn, dataset: UKESM1-0-LL, exp: ssp585, ensemble: r1i1p1f2, start_year: 2015, end_year: 2100}

preprocessors:
  # --------------------------------------------------
  # Time series preprocessors
  # --------------------------------------------------

  prep_regional_ts_2d: # For regional 2d fields
    #custom_order: true
    extract_region: &mpa_region
      start_longitude: -17.25 #14.25W
      end_longitude: -11.25 #
      start_latitude: -10.56 # -7.56
      end_latitude: -4.56 #
    area_statistics:
      operator: mean
      fx_variables: [{short_name: areacello, mip: Ofx, exp: piControl, ensemble: r1i1p1f2, grid: gn, activity: CMIP}]


  prep_regional_ts_3d_surface: # For regional fields
    #custom_order: true
    extract_surface:
#    extract_levels:
#      levels: [0.5, ]
#      scheme: nearest
    extract_region: *mpa_region
    area_statistics:
      operator: mean
      fx_variables: [{short_name: areacello, mip: Ofx, exp: piControl, ensemble: r1i1p1f2, grid: gn, activity: CMIP}]

  prep_regional_ts_3d_top:
    #custom_order: true
    extract_region: *mpa_region
    extract_volume:
      z_min: 0.
      z_max: 1000.
    volume_statistics:
      operator: mean
      fx_variables: [volcello, ]

  # --------------------------------------------------
  # Map preprocessors
  # --------------------------------------------------
  prep_map_1: # For Global 2D fields
#    extract_region:
#      start_longitude: -40.
#      end_longitude: 40.
#      start_latitude: -40.
#      end_latitude: 40.
    climate_statistics:
      operator: mean

  prep_map_surf: # For Global 2D fields
    extract_surface:
    climate_statistics:
       operator: mean

  prep_map_2: # For Global 2D fields with regridding
    #custom_order: true
    climate_statistics:
      operator: mean
    regrid:
      target_grid: 1x1
      scheme: linear

  # --------------------------------------------------
  # Depth-profile preprocessors
  # --------------------------------------------------
  prep_profile_2: # For a regional profile
    #custom_order: true
    extract_region: *mpa_region
    area_statistics:
      operator: mean
      fx_variables: [{short_name: areacello, mip: Ofx, exp: piControl, ensemble: r1i1p1f2, grid: gn, activity: CMIP}]
    extract_levels:
        scheme: linear
        levels: [0.5, 1., 5., 10., 50., 100., 200., 300., 400., 500., 600., 700., 800., 900., 1000.,
                     1500., 2000., 2500., 3000., 3500., 4000.,4500., 5000.]

diagnostics:
  # --------------------------------------------------
  # Time series diagnostics
  # --------------------------------------------------

  diag_timeseries_3:
    variables:
      tos_ts_hist:
        short_name: tos
        preprocessor: prep_regional_ts_2d
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: historical
        start_year: 1850
        end_year: 2014


      tos_ts_ssp126:
        short_name: tos
        preprocessor: prep_regional_ts_2d
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp126
        start_year: 2015
        end_year: 2100

      tos_ts_ssp245:
        short_name: tos
        preprocessor: prep_regional_ts_2d
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp245
        start_year: 2015
        end_year: 2100

      tos_ts_ssp370:
        short_name: tos
        preprocessor: prep_regional_ts_2d
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp370
        start_year: 2015
        end_year: 2100

      tos_ts_ssp585:
        short_name: tos
        preprocessor: prep_regional_ts_2d
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp585
        start_year: 2015
        end_year: 2100

      ###############
      tos_profile_hist:
        short_name: thetao
        preprocessor: prep_profile_2
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: historical
        start_year: 2000
        end_year: 2010

      tos_profile_ssp126:
        short_name: thetao
        preprocessor: prep_profile_2
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp126
        start_year: 2040
        end_year: 2050

      tos_profile_ssp245:
        short_name: thetao
        preprocessor: prep_profile_2
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp245
        start_year: 2040
        end_year: 2050

      tos_profile_ssp370:
        short_name: thetao
        preprocessor: prep_profile_2
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp370
        start_year: 2040
        end_year: 2050

      tos_profile_ssp585:
        short_name: thetao
        preprocessor: prep_profile_2
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp:  ssp585
        start_year: 2040
        end_year: 2050

      ###############
      #
      tos_map_hist:
        short_name: tos
        preprocessor: prep_map_2
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: historical
        start_year: 2000
        end_year: 2010

      tos_map_ssp126:
        short_name: tos
        preprocessor: prep_map_2
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp126
        start_year: 2040
        end_year: 2050

      tos_map_ssp245:
        short_name: tos
        preprocessor: prep_map_2
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp245
        start_year: 2040
        end_year: 2050

      tos_map_ssp370:
        short_name: tos
        preprocessor: prep_map_2
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp370
        start_year: 2040
        end_year: 2050

      tos_map_ssp585:
        short_name: tos
        preprocessor: prep_map_2
        project: CMIP6
        mip: Omon
        grid: gn
        #dataset: UKESM1-0-LL
        #ensemble: r1i1p1f2
        exp: ssp585
        start_year: 2040
        end_year: 2050

    scripts:
      Model_range_polots:
        script: ocean/diagnostic_ai_plots.py
