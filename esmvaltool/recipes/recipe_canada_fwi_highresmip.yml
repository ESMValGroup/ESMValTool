# ESMValTool
# recipe_canada_fwi.yml
---
documentation:
  description: Calculate 2023 FWI for Canadian ecozones using high resolution CMIP6 data

  title: Canada 2023 FWI calculations

  authors:
    - malinina_elizaveta

  maintainer:
    - malinina_elizaveta

preprocessors:
  preproc_canada:
    extract_shape:
      shapefile: canada.shp
      method: contains
      crop: True

datasets:
# In case issues with memory occur, it is recommended to split the timeseries
# in e.g. 20 year chunks. The issues occur currently at the stage of FWI calculation
  - {dataset: HadGEM3-GC31-LM, institute: MOHC, project: CMIP6, exp: [highresSST-present, highresSST-future],
    ensemble: 'r1i(1:3)p1f1', mip: day, start_year: 2010, end_year: 2030, grid: [gn,gr]}
  - {dataset: HadGEM3-GC31-LM, institute: MOHC, project: CMIP6, exp: [highresSST-present, highresSST-future],
    ensemble: 'r1i(14:15)p1f1', mip: day, start_year: 2010, end_year: 2030, grid: [gn,gr]}   
  - {dataset: CNRM-CM6-1-HR, institute: CNRM-CERFACS, project: CMIP6, exp: [highresSST-present, highresSST-future],
    ensemble: 'r(1:10)i1p1f2', mip: day, start_year: 2010, end_year: 2030, grid: [gn,gr]}
  - {dataset: EC-Earth3P, institute: EC-Earth-Consortium, project: CMIP6, exp: [highresSST-present, highresSST-future],
    ensemble: 'r(2:3)i1p1f1', mip: day, start_year: 2010, end_year: 2030, grid: [gn,gr]}
  - {dataset: EC-Earth3P-HR, institute: EC-Earth-Consortium, project: CMIP6, exp: [highresSST-present, highresSST-future],
    ensemble: r(2:3)i1p1f1, mip: day, start_year: 1950, end_year: 2030, grid: [gn,gr]}
  - {dataset: HadGEM3-GC31-HM, institute: MOHC, project: CMIP6, exp: [highresSST-present, highresSST-future],
    ensemble: 'r1i(1:3)p1f1', mip: day, start_year: 1950, end_year: 2030, grid: [gn,gr]}
  - {dataset: HadGEM3-GC31-LM, institute: MOHC, project: CMIP6, exp: [highresSST-present, highresSST-future],
    ensemble: 'r1i(1:3)p1f1', mip: day, start_year: 1950, end_year: 2030, grid: [gn,gr]}
  - {dataset: HadGEM3-GC31-LM, institute: MOHC, project: CMIP6, exp: [highresSST-present, highresSST-future],
    ensemble: 'r1i(14:15)p1f1', mip: day, start_year: 1950, end_year: 2030, grid: [gn,gr]}
  - {dataset: MRI-AGCM3-2-H, institute: MRI, project: CMIP6, exp: [highresSST-present, highresSST-future],
   ensemble: 'r1i1p1f1', mip: day, start_year: 2010, end_year: 2030, grid: [gn,gr]}
  - {dataset: MRI-AGCM3-2-S, institute: MRI, project: CMIP6, exp: [highresSST-present, highresSST-future],
   ensemble: 'r1i1p1f1', mip: day, start_year: 2010, end_year: 2030, grid: [gn,gr]}

diagnostics:
  calculate_fwi:
    description: Calculate FWI
    scripts: 
      calculate:
        script: fwi/calculate_fwi.py
        region: canada
        forest_mask: CAN_AK_forest_3km.tif
    variables:
      tasmin:
        preprocessor: preproc_canada
      tasmax:
        preprocessor: preproc_canada
      pr:
        preprocessor: preproc_canada
      hurs:
        preprocessor: preproc_canada
      sfcWind:
        preprocessor: preproc_canada
