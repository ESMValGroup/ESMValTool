# ESMValTool
---
documentation:
  title: Benchmarking of a single model for a region through extract_shape.
  description: >
    Benchmarking: time series.
  authors:
    - lauer_axel
    - bock_lisa
    - hassler_birgit
    - lindenlaub_lukas
    - schlund_manuel
    - weigel_katja
    - andela_bouwe
  maintainer:
    - lauer_axel
  references:
    - lauer25gmd
  projects:
    - dlrmabak


datasets:
  # Dataset to be benchmarked
  - {project: CMIP6, exp: historical, dataset: MIROC6, ensemble: r1i1p1f1, grid: gn}

preprocessors:
  pp_abs:
    regrid:
      target_grid: 1x1
      scheme: linear
    extract_shape:
      shapefile: ar6
      crop: true
      decomposed: true
      ids:
        Name:
          - E.Europe
          - N.Europe
          - West&Central-Europe
    area_statistics:
      operator: mean

  pp_abs_200:
    extract_levels:
      levels: 20000
      scheme: linear
      coordinate: air_pressure
    regrid:
      target_grid: 1x1
      scheme: linear
    extract_shape:
      shapefile: ar6
      crop: true
      decomposed: true
      ids:
        Name:
          - E.Europe
          - N.Europe
          - West&Central-Europe
    area_statistics:
      operator: mean

  pp:
    regrid:
      target_grid: 1x1
      scheme: linear
    extract_shape:
      shapefile: ar6
      decomposed: true
      ids:
        Name:
          - E.Europe
          - N.Europe
          - West&Central-Europe
    anomalies:
      period: month
      reference:
        start_year: 1980
        start_month: 1
        start_day: 1
        end_year: 2009
        end_month: 12
        end_day: 31
    area_statistics:
      operator: mean

  pp_200:
    extract_levels:
      levels: 20000
      scheme: linear
      coordinate: air_pressure
    regrid:
      target_grid: 1x1
      scheme: linear
    extract_shape:
      shapefile: ar6
      decomposed: true
      ids:
        Name:
          - E.Europe
          - N.Europe
          - West&Central-Europe
    anomalies:
      period: month
      reference:
        start_year: 1980
        start_month: 1
        start_day: 1
        end_year: 2009
        end_month: 12
        end_day: 31
    area_statistics:
      operator: mean


diagnostics:

  near-surface_air_temperature_anomalies:
    description: Plot "classical" time series of global mean anomalies including a reference dataset.
    variables:
      tas: &var_default
        start_year: 1980
        end_year: 2014
        preprocessor: pp
        mip: Amon
        additional_datasets:
          - {dataset: HadCRUT5, project: OBS, type: ground, version: 5.0.1.0-analysis, tier: 2}
    scripts:
      figures: &figures
        script: monitor/multi_datasets.py
        plot_folder: '{plot_dir}'
        group_variables_by: shape_id
        slices_over: [shape_id]
        plot_filename: "{plot_type}_{real_name}_{dataset}_{mip}_{exp}_{ensemble}_{shape_id}"
        plots:
          timeseries:
            plot_kwargs: &plot_kwargs
              default:
                color: red
                label: '{dataset}'
                linestyle: '-'
                linewidth: 2
                zorder: 4
              HadCRUT5:
                color: black
                label: '{dataset}'
                linestyle: '-'
                linewidth: 2
                zorder: 3
              ERA5:
                color: black
                label: '{dataset}'
                linestyle: '-'
                linewidth: 2
                zorder: 3
              ERA-5:
                color: black
                label: '{dataset}'
                linestyle: '-'
                linewidth: 2
                zorder: 3
              GPCP-V2.3:
                color: black
                label: '{dataset}'
                linestyle: '-'
                linewidth: 2
                zorder: 3
            pyplot_kwargs:
              title: '{long_name} Anomalies {shape_id}'
  precipitation_anomalies:
    description: Plot "classical" time series of global mean anomalies including a reference dataset.
    variables:
      pr:
        <<: *var_default
        additional_datasets:
          - {dataset: GPCP-V2.3, project: obs4MIPs, tier: 1}
    scripts:
      figures: *figures
  sea_level_pressure_anomalies:
    description: Plot "classical" time series of global mean anomalies including a reference dataset.
    variables:
      psl:
        <<: *var_default
        additional_datasets:
          - {dataset: ERA-5, project: obs4MIPs, tier: 1}
    scripts:
      figures: *figures
  specific_humidity_anomalies:
    description: Plot "classical" time series of global mean anomalies including a reference dataset.
    variables:
      hus_200:
        <<: *var_default
        short_name: hus
        preprocessor: pp_200
        additional_datasets:
          - {dataset: ERA5, project: native6, type: reanaly, version: v1, tier: 3}
    scripts:
      figures: *figures
  eastward_wind_anomalies:
    description: Plot "classical" time series of global mean anomalies including a reference dataset.
    variables:
      ua_200:
        <<: *var_default
        short_name: ua
        preprocessor: pp_200
        additional_datasets:
          - {dataset: ERA-5, project: obs4MIPs, tier: 1}
    scripts:
      figures: *figures

  near-surface_air_temperature:
    description: Plot "classical" time series of global mean including a reference dataset.
    variables:
      tas: &var_default_abs
        <<: *var_default
        preprocessor: pp_abs
        additional_datasets:
          - {dataset: HadCRUT5, project: OBS, type: ground, version: 5.0.1.0-analysis, tier: 2}
    scripts:
      figures: &figures_abs
        script: monitor/multi_datasets.py
        plot_folder: '{plot_dir}'
        group_variables_by: shape_id
        slices_over: [shape_id]
        plot_filename: "{plot_type}_{real_name}_{dataset}_{mip}_{exp}_{ensemble}_{shape_id}"
        plots:
          timeseries:
            plot_kwargs: *plot_kwargs
            pyplot_kwargs:
              title: '{long_name} {shape_id}'
  precipitation:
    description: Plot "classical" time series of global mean including a reference dataset.
    variables:
      pr:
        <<: *var_default_abs
        additional_datasets:
          - {dataset: GPCP-V2.3, project: obs4MIPs, tier: 1}
    scripts:
      figures: *figures_abs
  sea_level_pressure:
    description: Plot "classical" time series of global mean including a reference dataset.
    variables:
      psl:
        <<: *var_default_abs
        additional_datasets:
          - {dataset: ERA-5, project: obs4MIPs, tier: 1}
    scripts:
      figures: *figures_abs
  specific_humidity:
    description: Plot "classical" time series of global mean including a reference dataset.
    variables:
      hus_200:
        <<: *var_default_abs
        short_name: hus
        preprocessor: pp_abs_200
        additional_datasets:
          - {dataset: ERA5, project: native6, type: reanaly, version: v1, tier: 3}
    scripts:
      figures: *figures_abs
  eastward_wind:
    description: Plot "classical" time series of global mean including a reference dataset.
    variables:
      ua_200:
        <<: *var_default_abs
        short_name: ua
        preprocessor: pp_abs_200
        additional_datasets:
          - {dataset: ERA-5, project: obs4MIPs, tier: 1}
    scripts:
      figures: *figures_abs
